import { createNodeMiddleware as oauthNodeMiddleware } from "@octokit/oauth-app";
import { createNodeMiddleware as webhooksNodeMiddleware } from "@octokit/webhooks";
import { onUnhandledRequestDefault } from "./on-unhandled-request-default";
function noop() { }
export function createNodeMiddleware(app, { pathPrefix = "/api/github", onUnhandledRequest = onUnhandledRequestDefault, log, } = {}) {
    const logWithDefaults = Object.assign({
        debug: noop,
        info: noop,
        warn: console.warn.bind(console),
        error: console.error.bind(console),
    }, log);
    return webhooksNodeMiddleware(app.webhooks, {
        path: pathPrefix + "/webhooks",
        log: logWithDefaults,
        onUnhandledRequest: oauthNodeMiddleware(app.oauth, {
            onUnhandledRequest,
            pathPrefix: pathPrefix + "/oauth",
        }),
    });
}
