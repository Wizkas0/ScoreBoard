{"version":3,"file":"index.js","sources":["../dist-src/version.js","../dist-src/add-event-handler.js","../dist-src/oauth-app-octokit.js","../dist-src/methods/get-user-octokit.js","../dist-src/methods/get-web-flow-authorization-url.js","../dist-src/emit-event.js","../dist-src/methods/create-token.js","../dist-src/methods/check-token.js","../dist-src/methods/reset-token.js","../dist-src/methods/refresh-token.js","../dist-src/methods/scope-token.js","../dist-src/methods/delete-token.js","../dist-src/methods/delete-authorization.js","../dist-src/middleware/node/parse-request.js","../dist-src/middleware/node/middleware.js","../dist-src/middleware/node/on-unhandled-request-default.js","../dist-src/middleware/node/index.js","../dist-src/index.js"],"sourcesContent":["export const VERSION = \"3.3.2\";\n","export function addEventHandler(state, eventName, eventHandler) {\n    if (Array.isArray(eventName)) {\n        for (const singleEventName of eventName) {\n            addEventHandler(state, singleEventName, eventHandler);\n        }\n        return;\n    }\n    if (!state.eventHandlers[eventName]) {\n        state.eventHandlers[eventName] = [];\n    }\n    state.eventHandlers[eventName].push(eventHandler);\n}\n","import { Octokit } from \"@octokit/core\";\nimport { getUserAgent } from \"universal-user-agent\";\nimport { VERSION } from \"./version\";\nexport const OAuthAppOctokit = Octokit.defaults({\n    userAgent: `octokit-oauth-app.js/${VERSION} ${getUserAgent()}`,\n});\n","import { createOAuthUserAuth, } from \"@octokit/auth-oauth-user\";\nexport async function getUserOctokitWithState(state, options) {\n    return state.octokit.auth({\n        type: \"oauth-user\",\n        ...options,\n        factory(options) {\n            return new state.Octokit({\n                authStrategy: createOAuthUserAuth,\n                auth: options,\n            });\n        },\n    });\n}\n","import * as OAuthMethods from \"@octokit/oauth-methods\";\nexport function getWebFlowAuthorizationUrlWithState(state, options) {\n    const optionsWithDefaults = {\n        clientId: state.clientId,\n        request: state.octokit.request,\n        ...options,\n        allowSignup: options.allowSignup || state.allowSignup,\n        scopes: options.scopes || state.defaultScopes,\n    };\n    return OAuthMethods.getWebFlowAuthorizationUrl({\n        clientType: state.clientType,\n        ...optionsWithDefaults,\n    });\n}\n","export async function emitEvent(state, context) {\n    const { name, action } = context;\n    if (state.eventHandlers[`${name}.${action}`]) {\n        for (const eventHandler of state.eventHandlers[`${name}.${action}`]) {\n            await eventHandler(context);\n        }\n    }\n    if (state.eventHandlers[name]) {\n        for (const eventHandler of state.eventHandlers[name]) {\n            await eventHandler(context);\n        }\n    }\n}\n","import * as OAuthAppAuth from \"@octokit/auth-oauth-app\";\nimport { emitEvent } from \"../emit-event\";\nexport async function createTokenWithState(state, options) {\n    const authentication = await state.octokit.auth({\n        type: \"oauth-user\",\n        ...options,\n    });\n    await emitEvent(state, {\n        name: \"token\",\n        action: \"created\",\n        token: authentication.token,\n        scopes: authentication.scopes,\n        authentication,\n        octokit: new state.Octokit({\n            authStrategy: OAuthAppAuth.createOAuthUserAuth,\n            auth: {\n                clientType: state.clientType,\n                clientId: state.clientId,\n                clientSecret: state.clientSecret,\n                token: authentication.token,\n                scopes: authentication.scopes,\n                refreshToken: authentication.refreshToken,\n                expiresAt: authentication.expiresAt,\n                refreshTokenExpiresAt: authentication.refreshTokenExpiresAt,\n            },\n        }),\n    });\n    return { authentication };\n}\n","import * as OAuthMethods from \"@octokit/oauth-methods\";\nexport async function checkTokenWithState(state, options) {\n    return await OAuthMethods.checkToken({\n        // @ts-expect-error not worth the extra code to appease TS\n        clientType: state.clientType,\n        clientId: state.clientId,\n        clientSecret: state.clientSecret,\n        request: state.octokit.request,\n        ...options,\n    });\n}\n","import * as OAuthMethods from \"@octokit/oauth-methods\";\nimport { emitEvent } from \"../emit-event\";\nimport { createOAuthUserAuth } from \"@octokit/auth-oauth-user\";\nexport async function resetTokenWithState(state, options) {\n    const optionsWithDefaults = {\n        clientId: state.clientId,\n        clientSecret: state.clientSecret,\n        request: state.octokit.request,\n        ...options,\n    };\n    if (state.clientType === \"oauth-app\") {\n        const response = await OAuthMethods.resetToken({\n            clientType: \"oauth-app\",\n            ...optionsWithDefaults,\n        });\n        await emitEvent(state, {\n            name: \"token\",\n            action: \"reset\",\n            token: response.authentication.token,\n            scopes: response.authentication.scopes || undefined,\n            authentication: {\n                type: \"token\",\n                tokenType: \"oauth\",\n                ...response.authentication,\n            },\n            octokit: new state.Octokit({\n                authStrategy: createOAuthUserAuth,\n                auth: {\n                    clientType: state.clientType,\n                    clientId: state.clientId,\n                    clientSecret: state.clientSecret,\n                    token: response.authentication.token,\n                    scopes: response.authentication.scopes,\n                },\n            }),\n        });\n        return response;\n    }\n    const response = await OAuthMethods.resetToken({\n        clientType: \"github-app\",\n        ...optionsWithDefaults,\n    });\n    await emitEvent(state, {\n        name: \"token\",\n        action: \"reset\",\n        token: response.authentication.token,\n        authentication: {\n            type: \"token\",\n            tokenType: \"oauth\",\n            ...response.authentication,\n        },\n        octokit: new state.Octokit({\n            authStrategy: createOAuthUserAuth,\n            auth: {\n                clientType: state.clientType,\n                clientId: state.clientId,\n                clientSecret: state.clientSecret,\n                token: response.authentication.token,\n            },\n        }),\n    });\n    return response;\n}\n","import * as OAuthMethods from \"@octokit/oauth-methods\";\nimport { emitEvent } from \"../emit-event\";\nimport { createOAuthUserAuth } from \"@octokit/auth-oauth-user\";\nexport async function refreshTokenWithState(state, options) {\n    if (state.clientType === \"oauth-app\") {\n        throw new Error(\"[@octokit/oauth-app] app.refreshToken() is not supported for OAuth Apps\");\n    }\n    const response = await OAuthMethods.refreshToken({\n        clientType: \"github-app\",\n        clientId: state.clientId,\n        clientSecret: state.clientSecret,\n        request: state.octokit.request,\n        refreshToken: options.refreshToken,\n    });\n    await emitEvent(state, {\n        name: \"token\",\n        action: \"refreshed\",\n        token: response.authentication.token,\n        authentication: {\n            type: \"token\",\n            tokenType: \"oauth\",\n            ...response.authentication,\n        },\n        octokit: new state.Octokit({\n            authStrategy: createOAuthUserAuth,\n            auth: {\n                clientType: state.clientType,\n                clientId: state.clientId,\n                clientSecret: state.clientSecret,\n                token: response.authentication.token,\n            },\n        }),\n    });\n    return response;\n}\n","import * as OAuthMethods from \"@octokit/oauth-methods\";\nimport { createOAuthUserAuth } from \"@octokit/auth-oauth-user\";\nimport { emitEvent } from \"../emit-event\";\nexport async function scopeTokenWithState(state, options) {\n    if (state.clientType === \"oauth-app\") {\n        throw new Error(\"[@octokit/oauth-app] app.scopeToken() is not supported for OAuth Apps\");\n    }\n    const response = await OAuthMethods.scopeToken({\n        clientType: \"github-app\",\n        clientId: state.clientId,\n        clientSecret: state.clientSecret,\n        request: state.octokit.request,\n        ...options,\n    });\n    await emitEvent(state, {\n        name: \"token\",\n        action: \"scoped\",\n        token: response.authentication.token,\n        authentication: {\n            type: \"token\",\n            tokenType: \"oauth\",\n            ...response.authentication,\n        },\n        octokit: new state.Octokit({\n            authStrategy: createOAuthUserAuth,\n            auth: {\n                clientType: state.clientType,\n                clientId: state.clientId,\n                clientSecret: state.clientSecret,\n                token: response.authentication.token,\n            },\n        }),\n    });\n    return response;\n}\n","import * as OAuthMethods from \"@octokit/oauth-methods\";\nimport { createUnauthenticatedAuth } from \"@octokit/auth-unauthenticated\";\nimport { emitEvent } from \"../emit-event\";\nexport async function deleteTokenWithState(state, options) {\n    const optionsWithDefaults = {\n        clientId: state.clientId,\n        clientSecret: state.clientSecret,\n        request: state.octokit.request,\n        ...options,\n    };\n    const response = state.clientType === \"oauth-app\"\n        ? await OAuthMethods.deleteToken({\n            clientType: \"oauth-app\",\n            ...optionsWithDefaults,\n        })\n        : // istanbul ignore next\n            await OAuthMethods.deleteToken({\n                clientType: \"github-app\",\n                ...optionsWithDefaults,\n            });\n    await emitEvent(state, {\n        name: \"token\",\n        action: \"deleted\",\n        token: options.token,\n        octokit: new state.Octokit({\n            authStrategy: createUnauthenticatedAuth,\n            auth: {\n                reason: `Handling \"token.deleted\" event. The access for the token has been revoked.`,\n            },\n        }),\n    });\n    return response;\n}\n","import * as OAuthMethods from \"@octokit/oauth-methods\";\nimport { createUnauthenticatedAuth } from \"@octokit/auth-unauthenticated\";\nimport { emitEvent } from \"../emit-event\";\nexport async function deleteAuthorizationWithState(state, options) {\n    const optionsWithDefaults = {\n        clientId: state.clientId,\n        clientSecret: state.clientSecret,\n        request: state.octokit.request,\n        ...options,\n    };\n    const response = state.clientType === \"oauth-app\"\n        ? await OAuthMethods.deleteAuthorization({\n            clientType: \"oauth-app\",\n            ...optionsWithDefaults,\n        })\n        : // istanbul ignore next\n            await OAuthMethods.deleteAuthorization({\n                clientType: \"github-app\",\n                ...optionsWithDefaults,\n            });\n    await emitEvent(state, {\n        name: \"token\",\n        action: \"deleted\",\n        token: options.token,\n        octokit: new state.Octokit({\n            authStrategy: createUnauthenticatedAuth,\n            auth: {\n                reason: `Handling \"token.deleted\" event. The access for the token has been revoked.`,\n            },\n        }),\n    });\n    await emitEvent(state, {\n        name: \"authorization\",\n        action: \"deleted\",\n        token: options.token,\n        octokit: new state.Octokit({\n            authStrategy: createUnauthenticatedAuth,\n            auth: {\n                reason: `Handling \"authorization.deleted\" event. The access for the app has been revoked.`,\n            },\n        }),\n    });\n    return response;\n}\n","// @ts-ignore remove once Node 10 is out maintenance. Replace with Object.fromEntries\nimport fromEntries from \"fromentries\";\nexport async function parseRequest(request) {\n    const { searchParams } = new URL(request.url, \"http://localhost\");\n    const query = fromEntries(searchParams);\n    const headers = request.headers;\n    if (![\"POST\", \"PATCH\"].includes(request.method)) {\n        return { headers, query };\n    }\n    return new Promise((resolve, reject) => {\n        let bodyChunks = [];\n        request\n            .on(\"error\", reject)\n            .on(\"data\", (chunk) => bodyChunks.push(chunk))\n            .on(\"end\", async () => {\n            const bodyString = Buffer.concat(bodyChunks).toString();\n            if (!bodyString)\n                return resolve({ headers, query });\n            try {\n                resolve({ headers, query, body: JSON.parse(bodyString) });\n            }\n            catch (error) {\n                reject(error);\n            }\n        });\n    });\n}\n","import { parseRequest } from \"./parse-request\";\nexport async function middleware(app, options, request, response) {\n    // request.url mayb include ?query parameters which we don't want for `route`\n    // hence the workaround using new URL()\n    const { pathname } = new URL(request.url, \"http://localhost\");\n    const route = [request.method, pathname].join(\" \");\n    const routes = {\n        getLogin: `GET ${options.pathPrefix}/login`,\n        getCallback: `GET ${options.pathPrefix}/callback`,\n        createToken: `POST ${options.pathPrefix}/token`,\n        getToken: `GET ${options.pathPrefix}/token`,\n        patchToken: `PATCH ${options.pathPrefix}/token`,\n        patchRefreshToken: `PATCH ${options.pathPrefix}/refresh-token`,\n        scopeToken: `POST ${options.pathPrefix}/token/scoped`,\n        deleteToken: `DELETE ${options.pathPrefix}/token`,\n        deleteGrant: `DELETE ${options.pathPrefix}/grant`,\n    };\n    if (!Object.values(routes).includes(route)) {\n        options.onUnhandledRequest(request, response);\n        return;\n    }\n    let parsedRequest;\n    try {\n        parsedRequest = await parseRequest(request);\n    }\n    catch (error) {\n        response.writeHead(400, {\n            \"content-type\": \"application/json\",\n        });\n        return response.end(JSON.stringify({\n            error: \"[@octokit/oauth-app] request error\",\n        }));\n    }\n    const { headers, query, body = {} } = parsedRequest;\n    try {\n        if (route === routes.getLogin) {\n            const { url } = app.getWebFlowAuthorizationUrl({\n                state: query.state,\n                scopes: query.scopes?.split(\",\"),\n                allowSignup: query.allowSignup,\n                redirectUrl: query.redirectUrl,\n            });\n            response.writeHead(302, { location: url });\n            return response.end();\n        }\n        if (route === routes.getCallback) {\n            if (query.error) {\n                throw new Error(`[@octokit/oauth-app] ${query.error} ${query.error_description}`);\n            }\n            if (!query.state || !query.code) {\n                throw new Error('[@octokit/oauth-app] Both \"code\" & \"state\" parameters are required');\n            }\n            const { authentication: { token }, } = await app.createToken({\n                state: query.state,\n                code: query.code,\n            });\n            response.writeHead(200, {\n                \"content-type\": \"text/html\",\n            });\n            response.write(`<h1>Token created successfull</h1>\n    \n<p>Your token is: <strong>${token}</strong>. Copy it now as it cannot be shown again.</p>`);\n            return response.end();\n        }\n        if (route === routes.createToken) {\n            const { state: oauthState, code, redirectUrl } = body;\n            if (!oauthState || !code) {\n                throw new Error('[@octokit/oauth-app] Both \"code\" & \"state\" parameters are required');\n            }\n            const { authentication: { token, scopes }, } = await app.createToken({\n                state: oauthState,\n                code,\n                redirectUrl,\n            });\n            response.writeHead(201, {\n                \"content-type\": \"application/json\",\n            });\n            return response.end(JSON.stringify({ token, scopes }));\n        }\n        if (route === routes.getToken) {\n            const token = headers.authorization?.substr(\"token \".length);\n            if (!token) {\n                throw new Error('[@octokit/oauth-app] \"Authorization\" header is required');\n            }\n            const result = await app.checkToken({\n                token,\n            });\n            response.writeHead(200, {\n                \"content-type\": \"application/json\",\n            });\n            return response.end(JSON.stringify(result));\n        }\n        if (route === routes.patchToken) {\n            const token = headers.authorization?.substr(\"token \".length);\n            if (!token) {\n                throw new Error('[@octokit/oauth-app] \"Authorization\" header is required');\n            }\n            const result = await app.resetToken({\n                token,\n            });\n            response.writeHead(200, {\n                \"content-type\": \"application/json\",\n            });\n            return response.end(JSON.stringify(result));\n        }\n        if (route === routes.patchRefreshToken) {\n            const token = headers.authorization?.substr(\"token \".length);\n            if (!token) {\n                throw new Error('[@octokit/oauth-app] \"Authorization\" header is required');\n            }\n            const { refreshToken } = body;\n            if (!refreshToken) {\n                throw new Error(\"[@octokit/oauth-app] refreshToken must be sent in request body\");\n            }\n            const result = await app.refreshToken({ refreshToken });\n            response.writeHead(200, {\n                \"content-type\": \"application/json\",\n            });\n            return response.end(JSON.stringify(result));\n        }\n        if (route === routes.scopeToken) {\n            const token = headers.authorization?.substr(\"token \".length);\n            if (!token) {\n                throw new Error('[@octokit/oauth-app] \"Authorization\" header is required');\n            }\n            const result = await app.scopeToken({\n                token,\n                ...body,\n            });\n            response.writeHead(200, {\n                \"content-type\": \"application/json\",\n            });\n            return response.end(JSON.stringify(result));\n        }\n        if (route === routes.deleteToken) {\n            const token = headers.authorization?.substr(\"token \".length);\n            if (!token) {\n                throw new Error('[@octokit/oauth-app] \"Authorization\" header is required');\n            }\n            await app.deleteToken({\n                token,\n            });\n            response.writeHead(204);\n            return response.end();\n        }\n        // route === routes.deleteGrant\n        const token = headers.authorization?.substr(\"token \".length);\n        if (!token) {\n            throw new Error('[@octokit/oauth-app] \"Authorization\" header is required');\n        }\n        await app.deleteAuthorization({\n            token,\n        });\n        response.writeHead(204);\n        return response.end();\n    }\n    catch (error) {\n        response.writeHead(400, {\n            \"content-type\": \"application/json\",\n        });\n        response.end(JSON.stringify({\n            error: error.message,\n        }));\n    }\n}\n","export function onUnhandledRequestDefault(request, response) {\n    response.writeHead(404, {\n        \"content-type\": \"application/json\",\n    });\n    response.end(JSON.stringify({\n        error: `Unknown route: ${request.method} ${request.url}`,\n    }));\n}\n","import { middleware } from \"./middleware\";\nimport { onUnhandledRequestDefault } from \"./on-unhandled-request-default\";\nexport function createNodeMiddleware(app, { pathPrefix = \"/api/github/oauth\", onUnhandledRequest = onUnhandledRequestDefault, } = {}) {\n    return middleware.bind(null, app, {\n        pathPrefix,\n        onUnhandledRequest,\n    });\n}\n","import { createOAuthAppAuth } from \"@octokit/auth-oauth-app\";\nimport { VERSION } from \"./version\";\nimport { addEventHandler } from \"./add-event-handler\";\nimport { OAuthAppOctokit } from \"./oauth-app-octokit\";\nimport { getUserOctokitWithState, } from \"./methods/get-user-octokit\";\nimport { getWebFlowAuthorizationUrlWithState, } from \"./methods/get-web-flow-authorization-url\";\nimport { createTokenWithState, } from \"./methods/create-token\";\nimport { checkTokenWithState, } from \"./methods/check-token\";\nimport { resetTokenWithState, } from \"./methods/reset-token\";\nimport { refreshTokenWithState, } from \"./methods/refresh-token\";\nimport { scopeTokenWithState, } from \"./methods/scope-token\";\nimport { deleteTokenWithState, } from \"./methods/delete-token\";\nimport { deleteAuthorizationWithState, } from \"./methods/delete-authorization\";\nexport { createNodeMiddleware } from \"./middleware/node/index\";\nexport class OAuthApp {\n    constructor(options) {\n        const Octokit = options.Octokit || OAuthAppOctokit;\n        this.type = (options.clientType ||\n            \"oauth-app\");\n        const octokit = new Octokit({\n            authStrategy: createOAuthAppAuth,\n            auth: {\n                clientType: this.type,\n                clientId: options.clientId,\n                clientSecret: options.clientSecret,\n            },\n        });\n        const state = {\n            clientType: this.type,\n            clientId: options.clientId,\n            clientSecret: options.clientSecret,\n            // @ts-expect-error defaultScopes not permitted for GitHub Apps\n            defaultScopes: options.defaultScopes || [],\n            allowSignup: options.allowSignup,\n            baseUrl: options.baseUrl,\n            log: options.log,\n            Octokit,\n            octokit,\n            eventHandlers: {},\n        };\n        this.on = addEventHandler.bind(null, state);\n        // @ts-expect-error TODO: figure this out\n        this.octokit = octokit;\n        this.getUserOctokit = getUserOctokitWithState.bind(null, state);\n        this.getWebFlowAuthorizationUrl = getWebFlowAuthorizationUrlWithState.bind(null, state);\n        this.createToken = createTokenWithState.bind(null, state);\n        this.checkToken = checkTokenWithState.bind(null, state);\n        this.resetToken = resetTokenWithState.bind(null, state);\n        this.refreshToken = refreshTokenWithState.bind(null, state);\n        this.scopeToken = scopeTokenWithState.bind(null, state);\n        this.deleteToken = deleteTokenWithState.bind(null, state);\n        this.deleteAuthorization = deleteAuthorizationWithState.bind(null, state);\n    }\n    static defaults(defaults) {\n        const OAuthAppWithDefaults = class extends this {\n            constructor(...args) {\n                super({\n                    ...defaults,\n                    ...args[0],\n                });\n            }\n        };\n        return OAuthAppWithDefaults;\n    }\n}\nOAuthApp.VERSION = VERSION;\n"],"names":["VERSION","addEventHandler","state","eventName","eventHandler","Array","isArray","singleEventName","eventHandlers","push","OAuthAppOctokit","Octokit","defaults","userAgent","getUserAgent","getUserOctokitWithState","options","octokit","auth","type","factory","authStrategy","createOAuthUserAuth","getWebFlowAuthorizationUrlWithState","optionsWithDefaults","clientId","request","allowSignup","scopes","defaultScopes","OAuthMethods","clientType","emitEvent","context","name","action","createTokenWithState","authentication","token","OAuthAppAuth","clientSecret","refreshToken","expiresAt","refreshTokenExpiresAt","checkTokenWithState","resetTokenWithState","response","undefined","tokenType","refreshTokenWithState","Error","scopeTokenWithState","deleteTokenWithState","createUnauthenticatedAuth","reason","deleteAuthorizationWithState","parseRequest","searchParams","URL","url","query","fromEntries","headers","includes","method","Promise","resolve","reject","bodyChunks","on","chunk","bodyString","Buffer","concat","toString","body","JSON","parse","error","middleware","app","pathname","route","join","routes","getLogin","pathPrefix","getCallback","createToken","getToken","patchToken","patchRefreshToken","scopeToken","deleteToken","deleteGrant","Object","values","onUnhandledRequest","parsedRequest","writeHead","end","stringify","getWebFlowAuthorizationUrl","split","redirectUrl","location","error_description","code","write","oauthState","authorization","substr","length","result","checkToken","resetToken","deleteAuthorization","message","onUnhandledRequestDefault","createNodeMiddleware","bind","OAuthApp","constructor","createOAuthAppAuth","baseUrl","log","getUserOctokit","OAuthAppWithDefaults","args"],"mappings":"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"}